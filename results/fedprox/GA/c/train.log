2023-11-19 01:02 before_fed Round:   0 | Epochs:   0 | Domain: p | loss: 0.0577 | Acc: 98.25%
2023-11-19 01:02 before_fed Round:   0 | Epochs:   0 | Domain: a | loss: 0.2842 | Acc: 91.35%
2023-11-19 01:02 before_fed Round:   0 | Epochs:   0 | Domain: s | loss: 0.2129 | Acc: 92.96%
2023-11-19 01:02 after_fed Round:   0 | Epochs:   0 | Domain: p | loss: 0.2169 | Acc: 97.66%
2023-11-19 01:02 after_fed Round:   0 | Epochs:   0 | Domain: a | loss: 0.7869 | Acc: 72.12%
2023-11-19 01:02 after_fed Round:   0 | Epochs:   0 | Domain: s | loss: 1.2001 | Acc: 50.00%
2023-11-19 01:02 Model saved! Best Val Acc: 73.26%
2023-11-19 01:03 test_domain Round:   0 | Epochs:   0 | Domain: c | loss: 1.1701 | Acc: 55.84%
2023-11-19 01:03 Round 0 FedAvg weight: {'p': 0.30391756566342915, 'a': 0.3308807753847176, 's': 0.36520165895185314}
2023-11-19 01:03 before_fed Round:   1 | Epochs:   5 | Domain: p | loss: 0.0264 | Acc: 98.83%
2023-11-19 01:03 before_fed Round:   1 | Epochs:   5 | Domain: a | loss: 0.2603 | Acc: 91.35%
2023-11-19 01:03 before_fed Round:   1 | Epochs:   5 | Domain: s | loss: 0.1944 | Acc: 93.97%
2023-11-19 01:03 after_fed Round:   1 | Epochs:   5 | Domain: p | loss: 0.0551 | Acc: 99.42%
2023-11-19 01:03 after_fed Round:   1 | Epochs:   5 | Domain: a | loss: 0.4686 | Acc: 84.13%
2023-11-19 01:03 after_fed Round:   1 | Epochs:   5 | Domain: s | loss: 0.6602 | Acc: 76.13%
2023-11-19 01:03 Model saved! Best Val Acc: 85.86%
2023-11-19 01:03 test_domain Round:   1 | Epochs:   5 | Domain: c | loss: 1.0171 | Acc: 63.35%
2023-11-19 01:03 Round 1 FedAvg weight: {'p': 0.2764554274680761, 'a': 0.32785472262858806, 's': 0.3956898499033359}
2023-11-19 01:03 before_fed Round:   2 | Epochs:  10 | Domain: p | loss: 0.0228 | Acc: 98.83%
2023-11-19 01:04 before_fed Round:   2 | Epochs:  10 | Domain: a | loss: 0.2298 | Acc: 92.31%
2023-11-19 01:04 before_fed Round:   2 | Epochs:  10 | Domain: s | loss: 0.1737 | Acc: 93.72%
2023-11-19 01:04 after_fed Round:   2 | Epochs:  10 | Domain: p | loss: 0.0403 | Acc: 99.42%
2023-11-19 01:04 after_fed Round:   2 | Epochs:  10 | Domain: a | loss: 0.3909 | Acc: 87.50%
2023-11-19 01:04 after_fed Round:   2 | Epochs:  10 | Domain: s | loss: 0.4196 | Acc: 87.19%
2023-11-19 01:04 Model saved! Best Val Acc: 90.67%
2023-11-19 01:04 test_domain Round:   2 | Epochs:  10 | Domain: c | loss: 0.8950 | Acc: 69.37%
2023-11-19 01:04 Round 2 FedAvg weight: {'p': 0.2444736732355998, 'a': 0.3393723683593892, 's': 0.416153958405011}
2023-11-19 01:04 before_fed Round:   3 | Epochs:  15 | Domain: p | loss: 0.0228 | Acc: 99.42%
2023-11-19 01:04 before_fed Round:   3 | Epochs:  15 | Domain: a | loss: 0.2973 | Acc: 88.94%
2023-11-19 01:05 before_fed Round:   3 | Epochs:  15 | Domain: s | loss: 0.1717 | Acc: 94.22%
2023-11-19 01:05 after_fed Round:   3 | Epochs:  15 | Domain: p | loss: 0.0358 | Acc: 98.25%
2023-11-19 01:05 after_fed Round:   3 | Epochs:  15 | Domain: a | loss: 0.4138 | Acc: 86.06%
2023-11-19 01:05 after_fed Round:   3 | Epochs:  15 | Domain: s | loss: 0.3449 | Acc: 88.44%
2023-11-19 01:05 test_domain Round:   3 | Epochs:  15 | Domain: c | loss: 0.9365 | Acc: 70.26%
2023-11-19 01:05 Round 3 FedAvg weight: {'p': 0.23226197778214464, 'a': 0.33489598747234617, 's': 0.4328420347455092}
2023-11-19 01:05 before_fed Round:   4 | Epochs:  20 | Domain: p | loss: 0.0242 | Acc: 99.42%
2023-11-19 01:05 before_fed Round:   4 | Epochs:  20 | Domain: a | loss: 0.2219 | Acc: 93.27%
2023-11-19 01:06 before_fed Round:   4 | Epochs:  20 | Domain: s | loss: 0.2450 | Acc: 90.95%
2023-11-19 01:06 after_fed Round:   4 | Epochs:  20 | Domain: p | loss: 0.0506 | Acc: 98.25%
2023-11-19 01:06 after_fed Round:   4 | Epochs:  20 | Domain: a | loss: 0.4011 | Acc: 87.98%
2023-11-19 01:06 after_fed Round:   4 | Epochs:  20 | Domain: s | loss: 0.2523 | Acc: 91.46%
2023-11-19 01:06 Model saved! Best Val Acc: 91.87%
2023-11-19 01:06 test_domain Round:   4 | Epochs:  20 | Domain: c | loss: 0.8276 | Acc: 73.21%
2023-11-19 01:06 Round 4 FedAvg weight: {'p': 0.22993241094492906, 'a': 0.3708115699890941, 's': 0.39925601906597685}
2023-11-19 01:06 before_fed Round:   5 | Epochs:  25 | Domain: p | loss: 0.0263 | Acc: 99.42%
2023-11-19 01:06 before_fed Round:   5 | Epochs:  25 | Domain: a | loss: 0.3514 | Acc: 89.42%
2023-11-19 01:06 before_fed Round:   5 | Epochs:  25 | Domain: s | loss: 0.1880 | Acc: 94.72%
2023-11-19 01:06 after_fed Round:   5 | Epochs:  25 | Domain: p | loss: 0.0303 | Acc: 99.42%
2023-11-19 01:06 after_fed Round:   5 | Epochs:  25 | Domain: a | loss: 0.3780 | Acc: 88.94%
2023-11-19 01:06 after_fed Round:   5 | Epochs:  25 | Domain: s | loss: 0.2455 | Acc: 91.21%
2023-11-19 01:06 Model saved! Best Val Acc: 92.25%
2023-11-19 01:06 test_domain Round:   5 | Epochs:  25 | Domain: c | loss: 0.8970 | Acc: 72.53%
2023-11-19 01:06 Round 5 FedAvg weight: {'p': 0.21525209948936969, 'a': 0.3548136346069062, 's': 0.4299342659037242}
2023-11-19 01:07 before_fed Round:   6 | Epochs:  30 | Domain: p | loss: 0.0201 | Acc: 99.42%
2023-11-19 01:07 before_fed Round:   6 | Epochs:  30 | Domain: a | loss: 0.2508 | Acc: 91.83%
2023-11-19 01:07 before_fed Round:   6 | Epochs:  30 | Domain: s | loss: 0.1914 | Acc: 92.71%
2023-11-19 01:07 after_fed Round:   6 | Epochs:  30 | Domain: p | loss: 0.0330 | Acc: 99.42%
2023-11-19 01:07 after_fed Round:   6 | Epochs:  30 | Domain: a | loss: 0.4117 | Acc: 86.06%
2023-11-19 01:07 after_fed Round:   6 | Epochs:  30 | Domain: s | loss: 0.2224 | Acc: 92.21%
2023-11-19 01:07 test_domain Round:   6 | Epochs:  30 | Domain: c | loss: 0.9050 | Acc: 73.29%
2023-11-19 01:07 Round 6 FedAvg weight: {'p': 0.202416029920303, 'a': 0.3885098878127503, 's': 0.4090740822669466}
2023-11-19 01:07 before_fed Round:   7 | Epochs:  35 | Domain: p | loss: 0.0123 | Acc: 100.00%
2023-11-19 01:08 before_fed Round:   7 | Epochs:  35 | Domain: a | loss: 0.2497 | Acc: 92.31%
2023-11-19 01:08 before_fed Round:   7 | Epochs:  35 | Domain: s | loss: 0.1329 | Acc: 94.47%
2023-11-19 01:08 after_fed Round:   7 | Epochs:  35 | Domain: p | loss: 0.0406 | Acc: 98.83%
2023-11-19 01:08 after_fed Round:   7 | Epochs:  35 | Domain: a | loss: 0.3492 | Acc: 91.35%
2023-11-19 01:08 after_fed Round:   7 | Epochs:  35 | Domain: s | loss: 0.2002 | Acc: 92.96%
2023-11-19 01:08 Model saved! Best Val Acc: 93.52%
2023-11-19 01:08 test_domain Round:   7 | Epochs:  35 | Domain: c | loss: 0.8726 | Acc: 74.15%
2023-11-19 01:08 Round 7 FedAvg weight: {'p': 0.21673592432518837, 'a': 0.37355996770582006, 's': 0.4097041079689916}
2023-11-19 01:08 before_fed Round:   8 | Epochs:  40 | Domain: p | loss: 0.0104 | Acc: 100.00%
2023-11-19 01:08 before_fed Round:   8 | Epochs:  40 | Domain: a | loss: 0.2872 | Acc: 91.83%
2023-11-19 01:09 before_fed Round:   8 | Epochs:  40 | Domain: s | loss: 0.1593 | Acc: 94.72%
2023-11-19 01:09 after_fed Round:   8 | Epochs:  40 | Domain: p | loss: 0.0343 | Acc: 98.83%
2023-11-19 01:09 after_fed Round:   8 | Epochs:  40 | Domain: a | loss: 0.3446 | Acc: 90.38%
2023-11-19 01:09 after_fed Round:   8 | Epochs:  40 | Domain: s | loss: 0.2007 | Acc: 94.22%
2023-11-19 01:09 Model saved! Best Val Acc: 93.79%
2023-11-19 01:09 test_domain Round:   8 | Epochs:  40 | Domain: c | loss: 1.0244 | Acc: 70.99%
2023-11-19 01:09 Round 8 FedAvg weight: {'p': 0.2335940183997412, 'a': 0.3830659558065374, 's': 0.38334002579372134}
2023-11-19 01:09 before_fed Round:   9 | Epochs:  45 | Domain: p | loss: 0.0092 | Acc: 100.00%
2023-11-19 01:09 before_fed Round:   9 | Epochs:  45 | Domain: a | loss: 0.2318 | Acc: 93.27%
2023-11-19 01:09 before_fed Round:   9 | Epochs:  45 | Domain: s | loss: 0.1833 | Acc: 94.47%
2023-11-19 01:09 after_fed Round:   9 | Epochs:  45 | Domain: p | loss: 0.0259 | Acc: 98.83%
2023-11-19 01:09 after_fed Round:   9 | Epochs:  45 | Domain: a | loss: 0.3383 | Acc: 90.87%
2023-11-19 01:09 after_fed Round:   9 | Epochs:  45 | Domain: s | loss: 0.2052 | Acc: 93.47%
2023-11-19 01:10 test_domain Round:   9 | Epochs:  45 | Domain: c | loss: 0.9747 | Acc: 72.53%
2023-11-19 01:10 Round 9 FedAvg weight: {'p': 0.23560989273751715, 'a': 0.3961573093523502, 's': 0.3682327979101327}
2023-11-19 01:10 before_fed Round:  10 | Epochs:  50 | Domain: p | loss: 0.0078 | Acc: 100.00%
2023-11-19 01:10 before_fed Round:  10 | Epochs:  50 | Domain: a | loss: 0.2420 | Acc: 95.19%
2023-11-19 01:10 before_fed Round:  10 | Epochs:  50 | Domain: s | loss: 0.1466 | Acc: 94.72%
2023-11-19 01:10 after_fed Round:  10 | Epochs:  50 | Domain: p | loss: 0.0249 | Acc: 99.42%
2023-11-19 01:10 after_fed Round:  10 | Epochs:  50 | Domain: a | loss: 0.3024 | Acc: 92.31%
2023-11-19 01:10 after_fed Round:  10 | Epochs:  50 | Domain: s | loss: 0.2285 | Acc: 93.72%
2023-11-19 01:10 Model saved! Best Val Acc: 94.50%
2023-11-19 01:10 test_domain Round:  10 | Epochs:  50 | Domain: c | loss: 0.9076 | Acc: 73.46%
2023-11-19 01:10 Round 10 FedAvg weight: {'p': 0.22782578585644556, 'a': 0.41459727273670177, 's': 0.3575769414068526}
2023-11-19 01:10 before_fed Round:  11 | Epochs:  55 | Domain: p | loss: 0.0125 | Acc: 99.42%
2023-11-19 01:11 before_fed Round:  11 | Epochs:  55 | Domain: a | loss: 0.2652 | Acc: 92.31%
2023-11-19 01:11 before_fed Round:  11 | Epochs:  55 | Domain: s | loss: 0.1734 | Acc: 95.73%
2023-11-19 01:11 after_fed Round:  11 | Epochs:  55 | Domain: p | loss: 0.0260 | Acc: 98.83%
2023-11-19 01:11 after_fed Round:  11 | Epochs:  55 | Domain: a | loss: 0.3090 | Acc: 90.87%
2023-11-19 01:11 after_fed Round:  11 | Epochs:  55 | Domain: s | loss: 0.2147 | Acc: 92.96%
2023-11-19 01:11 test_domain Round:  11 | Epochs:  55 | Domain: c | loss: 0.9498 | Acc: 73.76%
2023-11-19 01:11 Round 11 FedAvg weight: {'p': 0.21939024373924387, 'a': 0.4055408391737598, 's': 0.3750689170869962}
2023-11-19 01:11 before_fed Round:  12 | Epochs:  60 | Domain: p | loss: 0.0164 | Acc: 99.42%
2023-11-19 01:11 before_fed Round:  12 | Epochs:  60 | Domain: a | loss: 0.2941 | Acc: 91.83%
2023-11-19 01:12 before_fed Round:  12 | Epochs:  60 | Domain: s | loss: 0.2291 | Acc: 92.96%
2023-11-19 01:12 after_fed Round:  12 | Epochs:  60 | Domain: p | loss: 0.0245 | Acc: 99.42%
2023-11-19 01:12 after_fed Round:  12 | Epochs:  60 | Domain: a | loss: 0.3376 | Acc: 90.38%
2023-11-19 01:12 after_fed Round:  12 | Epochs:  60 | Domain: s | loss: 0.2104 | Acc: 93.22%
2023-11-19 01:12 test_domain Round:  12 | Epochs:  60 | Domain: c | loss: 0.8987 | Acc: 75.00%
2023-11-19 01:12 Round 12 FedAvg weight: {'p': 0.21096971333298564, 'a': 0.4364537931635443, 's': 0.35257649350347}
2023-11-19 01:12 before_fed Round:  13 | Epochs:  65 | Domain: p | loss: 0.0154 | Acc: 99.42%
2023-11-19 01:12 before_fed Round:  13 | Epochs:  65 | Domain: a | loss: 0.2858 | Acc: 92.31%
2023-11-19 01:13 before_fed Round:  13 | Epochs:  65 | Domain: s | loss: 0.1357 | Acc: 95.48%
2023-11-19 01:13 after_fed Round:  13 | Epochs:  65 | Domain: p | loss: 0.0196 | Acc: 99.42%
2023-11-19 01:13 after_fed Round:  13 | Epochs:  65 | Domain: a | loss: 0.3198 | Acc: 91.35%
2023-11-19 01:13 after_fed Round:  13 | Epochs:  65 | Domain: s | loss: 0.2096 | Acc: 93.47%
2023-11-19 01:13 test_domain Round:  13 | Epochs:  65 | Domain: c | loss: 0.9293 | Acc: 74.15%
2023-11-19 01:13 Round 13 FedAvg weight: {'p': 0.19735417303018218, 'a': 0.42916897823859046, 's': 0.37347684873122744}
2023-11-19 01:13 before_fed Round:  14 | Epochs:  70 | Domain: p | loss: 0.0176 | Acc: 99.42%
2023-11-19 01:13 before_fed Round:  14 | Epochs:  70 | Domain: a | loss: 0.2544 | Acc: 94.23%
2023-11-19 01:13 before_fed Round:  14 | Epochs:  70 | Domain: s | loss: 0.2174 | Acc: 93.72%
2023-11-19 01:13 after_fed Round:  14 | Epochs:  70 | Domain: p | loss: 0.0305 | Acc: 98.83%
2023-11-19 01:13 after_fed Round:  14 | Epochs:  70 | Domain: a | loss: 0.3532 | Acc: 90.87%
2023-11-19 01:13 after_fed Round:  14 | Epochs:  70 | Domain: s | loss: 0.1951 | Acc: 93.47%
2023-11-19 01:13 test_domain Round:  14 | Epochs:  70 | Domain: c | loss: 0.9403 | Acc: 74.45%
2023-11-19 01:13 Round 14 FedAvg weight: {'p': 0.1942603310769333, 'a': 0.4489474667856045, 's': 0.3567922021374623}
2023-11-19 01:14 before_fed Round:  15 | Epochs:  75 | Domain: p | loss: 0.0272 | Acc: 99.42%
2023-11-19 01:14 before_fed Round:  15 | Epochs:  75 | Domain: a | loss: 0.2781 | Acc: 92.31%
2023-11-19 01:14 before_fed Round:  15 | Epochs:  75 | Domain: s | loss: 0.1807 | Acc: 94.47%
2023-11-19 01:14 after_fed Round:  15 | Epochs:  75 | Domain: p | loss: 0.0440 | Acc: 97.66%
2023-11-19 01:14 after_fed Round:  15 | Epochs:  75 | Domain: a | loss: 0.3674 | Acc: 88.94%
2023-11-19 01:14 after_fed Round:  15 | Epochs:  75 | Domain: s | loss: 0.1707 | Acc: 94.47%
2023-11-19 01:14 test_domain Round:  15 | Epochs:  75 | Domain: c | loss: 0.9641 | Acc: 74.66%
2023-11-19 01:14 Round 15 FedAvg weight: {'p': 0.20343881331683975, 'a': 0.46183517469286123, 's': 0.334726011990299}
2023-11-19 01:14 before_fed Round:  16 | Epochs:  80 | Domain: p | loss: 0.0178 | Acc: 98.83%
2023-11-19 01:15 before_fed Round:  16 | Epochs:  80 | Domain: a | loss: 0.2910 | Acc: 92.31%
2023-11-19 01:15 before_fed Round:  16 | Epochs:  80 | Domain: s | loss: 0.1788 | Acc: 94.22%
2023-11-19 01:15 after_fed Round:  16 | Epochs:  80 | Domain: p | loss: 0.0296 | Acc: 99.42%
2023-11-19 01:15 after_fed Round:  16 | Epochs:  80 | Domain: a | loss: 0.3054 | Acc: 91.83%
2023-11-19 01:15 after_fed Round:  16 | Epochs:  80 | Domain: s | loss: 0.2044 | Acc: 93.72%
2023-11-19 01:15 test_domain Round:  16 | Epochs:  80 | Domain: c | loss: 0.9579 | Acc: 74.45%
2023-11-19 01:15 Round 16 FedAvg weight: {'p': 0.15730589240686532, 'a': 0.48239378044453834, 's': 0.3603003271485963}
2023-11-19 01:15 before_fed Round:  17 | Epochs:  85 | Domain: p | loss: 0.0080 | Acc: 100.00%
2023-11-19 01:15 before_fed Round:  17 | Epochs:  85 | Domain: a | loss: 0.2592 | Acc: 92.79%
2023-11-19 01:16 before_fed Round:  17 | Epochs:  85 | Domain: s | loss: 0.1559 | Acc: 94.72%
2023-11-19 01:16 after_fed Round:  17 | Epochs:  85 | Domain: p | loss: 0.0369 | Acc: 98.83%
2023-11-19 01:16 after_fed Round:  17 | Epochs:  85 | Domain: a | loss: 0.3236 | Acc: 91.83%
2023-11-19 01:16 after_fed Round:  17 | Epochs:  85 | Domain: s | loss: 0.2302 | Acc: 93.72%
2023-11-19 01:16 test_domain Round:  17 | Epochs:  85 | Domain: c | loss: 1.0100 | Acc: 74.15%
2023-11-19 01:16 Round 17 FedAvg weight: {'p': 0.17819348716266623, 'a': 0.4653649877979352, 's': 0.3564415250393986}
2023-11-19 01:16 before_fed Round:  18 | Epochs:  90 | Domain: p | loss: 0.0113 | Acc: 99.42%
2023-11-19 01:16 before_fed Round:  18 | Epochs:  90 | Domain: a | loss: 0.2432 | Acc: 93.27%
2023-11-19 01:16 before_fed Round:  18 | Epochs:  90 | Domain: s | loss: 0.1497 | Acc: 95.48%
2023-11-19 01:16 after_fed Round:  18 | Epochs:  90 | Domain: p | loss: 0.0336 | Acc: 99.42%
2023-11-19 01:17 after_fed Round:  18 | Epochs:  90 | Domain: a | loss: 0.3110 | Acc: 91.35%
2023-11-19 01:17 after_fed Round:  18 | Epochs:  90 | Domain: s | loss: 0.1889 | Acc: 94.72%
2023-11-19 01:17 test_domain Round:  18 | Epochs:  90 | Domain: c | loss: 0.9184 | Acc: 74.87%
2023-11-19 01:17 Round 18 FedAvg weight: {'p': 0.16916699690089407, 'a': 0.4781832023524777, 's': 0.3526498007466283}
2023-11-19 01:17 before_fed Round:  19 | Epochs:  95 | Domain: p | loss: 0.0069 | Acc: 99.42%
2023-11-19 01:17 before_fed Round:  19 | Epochs:  95 | Domain: a | loss: 0.2778 | Acc: 91.35%
2023-11-19 01:17 before_fed Round:  19 | Epochs:  95 | Domain: s | loss: 0.1389 | Acc: 95.23%
2023-11-19 01:17 after_fed Round:  19 | Epochs:  95 | Domain: p | loss: 0.0279 | Acc: 99.42%
2023-11-19 01:17 after_fed Round:  19 | Epochs:  95 | Domain: a | loss: 0.3251 | Acc: 90.87%
2023-11-19 01:17 after_fed Round:  19 | Epochs:  95 | Domain: s | loss: 0.1879 | Acc: 92.96%
2023-11-19 01:17 test_domain Round:  19 | Epochs:  95 | Domain: c | loss: 0.9997 | Acc: 73.68%
2023-11-19 01:17 Round 19 FedAvg weight: {'p': 0.16196564000808447, 'a': 0.4652909055034377, 's': 0.37274345448847784}
2023-11-19 01:17 before_fed Round:  20 | Epochs: 100 | Domain: p | loss: 0.0154 | Acc: 99.42%
2023-11-19 01:18 before_fed Round:  20 | Epochs: 100 | Domain: a | loss: 0.2369 | Acc: 94.23%
2023-11-19 01:18 before_fed Round:  20 | Epochs: 100 | Domain: s | loss: 0.1571 | Acc: 94.22%
2023-11-19 01:18 after_fed Round:  20 | Epochs: 100 | Domain: p | loss: 0.0386 | Acc: 98.25%
2023-11-19 01:18 after_fed Round:  20 | Epochs: 100 | Domain: a | loss: 0.3555 | Acc: 89.90%
2023-11-19 01:18 after_fed Round:  20 | Epochs: 100 | Domain: s | loss: 0.2159 | Acc: 93.72%
2023-11-19 01:18 test_domain Round:  20 | Epochs: 100 | Domain: c | loss: 0.9610 | Acc: 73.93%
2023-11-19 01:18 Round 20 FedAvg weight: {'p': 0.16349276750053485, 'a': 0.47713758606631335, 's': 0.35936964643315183}
2023-11-19 01:18 before_fed Round:  21 | Epochs: 105 | Domain: p | loss: 0.0043 | Acc: 100.00%
2023-11-19 01:18 before_fed Round:  21 | Epochs: 105 | Domain: a | loss: 0.2460 | Acc: 93.27%
2023-11-19 01:19 before_fed Round:  21 | Epochs: 105 | Domain: s | loss: 0.1664 | Acc: 94.97%
2023-11-19 01:19 after_fed Round:  21 | Epochs: 105 | Domain: p | loss: 0.0280 | Acc: 98.83%
2023-11-19 01:19 after_fed Round:  21 | Epochs: 105 | Domain: a | loss: 0.3306 | Acc: 91.35%
2023-11-19 01:19 after_fed Round:  21 | Epochs: 105 | Domain: s | loss: 0.2302 | Acc: 93.72%
2023-11-19 01:19 test_domain Round:  21 | Epochs: 105 | Domain: c | loss: 0.9964 | Acc: 73.68%
2023-11-19 01:19 Round 21 FedAvg weight: {'p': 0.17088412229478372, 'a': 0.4746880855213876, 's': 0.3544277921838286}
2023-11-19 01:19 before_fed Round:  22 | Epochs: 110 | Domain: p | loss: 0.0106 | Acc: 99.42%
2023-11-19 01:19 before_fed Round:  22 | Epochs: 110 | Domain: a | loss: 0.2440 | Acc: 94.23%
2023-11-19 01:20 before_fed Round:  22 | Epochs: 110 | Domain: s | loss: 0.1784 | Acc: 95.48%
2023-11-19 01:20 after_fed Round:  22 | Epochs: 110 | Domain: p | loss: 0.0419 | Acc: 97.66%
2023-11-19 01:20 after_fed Round:  22 | Epochs: 110 | Domain: a | loss: 0.3130 | Acc: 92.79%
2023-11-19 01:20 after_fed Round:  22 | Epochs: 110 | Domain: s | loss: 0.2379 | Acc: 92.71%
2023-11-19 01:20 test_domain Round:  22 | Epochs: 110 | Domain: c | loss: 0.8813 | Acc: 75.94%
2023-11-19 01:20 Round 22 FedAvg weight: {'p': 0.17877597969179354, 'a': 0.4598115152157924, 's': 0.361412505092414}
2023-11-19 01:20 before_fed Round:  23 | Epochs: 115 | Domain: p | loss: 0.0194 | Acc: 99.42%
2023-11-19 01:20 before_fed Round:  23 | Epochs: 115 | Domain: a | loss: 0.2451 | Acc: 92.79%
2023-11-19 01:20 before_fed Round:  23 | Epochs: 115 | Domain: s | loss: 0.1457 | Acc: 95.23%
2023-11-19 01:20 after_fed Round:  23 | Epochs: 115 | Domain: p | loss: 0.0409 | Acc: 98.25%
2023-11-19 01:20 after_fed Round:  23 | Epochs: 115 | Domain: a | loss: 0.2677 | Acc: 92.79%
2023-11-19 01:20 after_fed Round:  23 | Epochs: 115 | Domain: s | loss: 0.2276 | Acc: 93.22%
2023-11-19 01:20 test_domain Round:  23 | Epochs: 115 | Domain: c | loss: 0.8730 | Acc: 76.66%
2023-11-19 01:20 Round 23 FedAvg weight: {'p': 0.18734161029113533, 'a': 0.43897925412109823, 's': 0.37367913558776655}
2023-11-19 01:21 before_fed Round:  24 | Epochs: 120 | Domain: p | loss: 0.0289 | Acc: 98.25%
2023-11-19 01:21 before_fed Round:  24 | Epochs: 120 | Domain: a | loss: 0.3147 | Acc: 92.31%
2023-11-19 01:21 before_fed Round:  24 | Epochs: 120 | Domain: s | loss: 0.1510 | Acc: 94.47%
2023-11-19 01:21 after_fed Round:  24 | Epochs: 120 | Domain: p | loss: 0.0390 | Acc: 98.83%
2023-11-19 01:21 after_fed Round:  24 | Epochs: 120 | Domain: a | loss: 0.2914 | Acc: 91.35%
2023-11-19 01:21 after_fed Round:  24 | Epochs: 120 | Domain: s | loss: 0.1739 | Acc: 95.48%
2023-11-19 01:21 test_domain Round:  24 | Epochs: 120 | Domain: c | loss: 0.8400 | Acc: 77.01%
2023-11-19 01:21 Round 24 FedAvg weight: {'p': 0.17393606613719198, 'a': 0.47449095988573736, 's': 0.3515729739770707}
2023-11-19 01:21 before_fed Round:  25 | Epochs: 125 | Domain: p | loss: 0.0143 | Acc: 99.42%
2023-11-19 01:22 before_fed Round:  25 | Epochs: 125 | Domain: a | loss: 0.2769 | Acc: 93.27%
2023-11-19 01:22 before_fed Round:  25 | Epochs: 125 | Domain: s | loss: 0.1620 | Acc: 93.97%
2023-11-19 01:22 after_fed Round:  25 | Epochs: 125 | Domain: p | loss: 0.0402 | Acc: 99.42%
2023-11-19 01:22 after_fed Round:  25 | Epochs: 125 | Domain: a | loss: 0.3192 | Acc: 89.90%
2023-11-19 01:22 after_fed Round:  25 | Epochs: 125 | Domain: s | loss: 0.1829 | Acc: 95.73%
2023-11-19 01:22 test_domain Round:  25 | Epochs: 125 | Domain: c | loss: 0.8696 | Acc: 76.19%
2023-11-19 01:22 Round 25 FedAvg weight: {'p': 0.17174963857741252, 'a': 0.4948579276410605, 's': 0.33339243378152694}
2023-11-19 01:22 before_fed Round:  26 | Epochs: 130 | Domain: p | loss: 0.0080 | Acc: 99.42%
2023-11-19 01:22 before_fed Round:  26 | Epochs: 130 | Domain: a | loss: 0.2843 | Acc: 92.79%
2023-11-19 01:23 before_fed Round:  26 | Epochs: 130 | Domain: s | loss: 0.2315 | Acc: 93.47%
2023-11-19 01:23 after_fed Round:  26 | Epochs: 130 | Domain: p | loss: 0.0441 | Acc: 98.25%
2023-11-19 01:23 after_fed Round:  26 | Epochs: 130 | Domain: a | loss: 0.3034 | Acc: 91.35%
2023-11-19 01:23 after_fed Round:  26 | Epochs: 130 | Domain: s | loss: 0.1765 | Acc: 94.22%
2023-11-19 01:23 test_domain Round:  26 | Epochs: 130 | Domain: c | loss: 0.9383 | Acc: 75.34%
2023-11-19 01:23 Round 26 FedAvg weight: {'p': 0.18603093716940194, 'a': 0.5036369997629223, 's': 0.3103320630676757}
2023-11-19 01:23 before_fed Round:  27 | Epochs: 135 | Domain: p | loss: 0.0103 | Acc: 100.00%
2023-11-19 01:23 before_fed Round:  27 | Epochs: 135 | Domain: a | loss: 0.2780 | Acc: 92.31%
2023-11-19 01:24 before_fed Round:  27 | Epochs: 135 | Domain: s | loss: 0.1833 | Acc: 94.47%
2023-11-19 01:24 after_fed Round:  27 | Epochs: 135 | Domain: p | loss: 0.0478 | Acc: 98.25%
2023-11-19 01:24 after_fed Round:  27 | Epochs: 135 | Domain: a | loss: 0.3076 | Acc: 90.87%
2023-11-19 01:24 after_fed Round:  27 | Epochs: 135 | Domain: s | loss: 0.2076 | Acc: 92.96%
2023-11-19 01:24 test_domain Round:  27 | Epochs: 135 | Domain: c | loss: 1.0138 | Acc: 73.72%
2023-11-19 01:24 Round 27 FedAvg weight: {'p': 0.19703643438984236, 'a': 0.49203490025793767, 's': 0.3109286653522199}
2023-11-19 01:24 before_fed Round:  28 | Epochs: 140 | Domain: p | loss: 0.0196 | Acc: 98.83%
2023-11-19 01:24 before_fed Round:  28 | Epochs: 140 | Domain: a | loss: 0.2547 | Acc: 93.27%
2023-11-19 01:24 before_fed Round:  28 | Epochs: 140 | Domain: s | loss: 0.1353 | Acc: 94.72%
2023-11-19 01:24 after_fed Round:  28 | Epochs: 140 | Domain: p | loss: 0.0268 | Acc: 99.42%
2023-11-19 01:24 after_fed Round:  28 | Epochs: 140 | Domain: a | loss: 0.3008 | Acc: 92.79%
2023-11-19 01:24 after_fed Round:  28 | Epochs: 140 | Domain: s | loss: 0.1925 | Acc: 94.47%
2023-11-19 01:24 Model saved! Best Val Acc: 94.62%
2023-11-19 01:24 test_domain Round:  28 | Epochs: 140 | Domain: c | loss: 0.9765 | Acc: 74.49%
2023-11-19 01:24 Round 28 FedAvg weight: {'p': 0.1744183368769681, 'a': 0.5070813331657473, 's': 0.31850032995728456}
2023-11-19 01:25 before_fed Round:  29 | Epochs: 145 | Domain: p | loss: 0.0174 | Acc: 99.42%
2023-11-19 01:25 before_fed Round:  29 | Epochs: 145 | Domain: a | loss: 0.2829 | Acc: 92.31%
2023-11-19 01:25 before_fed Round:  29 | Epochs: 145 | Domain: s | loss: 0.1709 | Acc: 93.72%
2023-11-19 01:25 after_fed Round:  29 | Epochs: 145 | Domain: p | loss: 0.0311 | Acc: 98.83%
2023-11-19 01:25 after_fed Round:  29 | Epochs: 145 | Domain: a | loss: 0.3039 | Acc: 90.87%
2023-11-19 01:25 after_fed Round:  29 | Epochs: 145 | Domain: s | loss: 0.1804 | Acc: 94.22%
2023-11-19 01:25 test_domain Round:  29 | Epochs: 145 | Domain: c | loss: 0.9592 | Acc: 75.21%
2023-11-19 01:25 Round 29 FedAvg weight: {'p': 0.1787485772178238, 'a': 0.5161690105204982, 's': 0.3050824122616779}
2023-11-19 01:25 before_fed Round:  30 | Epochs: 150 | Domain: p | loss: 0.0195 | Acc: 98.83%
2023-11-19 01:25 before_fed Round:  30 | Epochs: 150 | Domain: a | loss: 0.2761 | Acc: 93.75%
2023-11-19 01:26 before_fed Round:  30 | Epochs: 150 | Domain: s | loss: 0.1575 | Acc: 94.97%
2023-11-19 01:26 after_fed Round:  30 | Epochs: 150 | Domain: p | loss: 0.0377 | Acc: 98.25%
2023-11-19 01:26 after_fed Round:  30 | Epochs: 150 | Domain: a | loss: 0.3168 | Acc: 92.31%
2023-11-19 01:26 after_fed Round:  30 | Epochs: 150 | Domain: s | loss: 0.1956 | Acc: 94.22%
2023-11-19 01:26 test_domain Round:  30 | Epochs: 150 | Domain: c | loss: 1.0358 | Acc: 73.59%
2023-11-19 01:26 Round 30 FedAvg weight: {'p': 0.17982550863275068, 'a': 0.5162538187497274, 's': 0.30392067261752187}
2023-11-19 01:26 before_fed Round:  31 | Epochs: 155 | Domain: p | loss: 0.0120 | Acc: 99.42%
2023-11-19 01:26 before_fed Round:  31 | Epochs: 155 | Domain: a | loss: 0.2397 | Acc: 93.27%
2023-11-19 01:27 before_fed Round:  31 | Epochs: 155 | Domain: s | loss: 0.1730 | Acc: 94.22%
2023-11-19 01:27 after_fed Round:  31 | Epochs: 155 | Domain: p | loss: 0.0474 | Acc: 98.25%
2023-11-19 01:27 after_fed Round:  31 | Epochs: 155 | Domain: a | loss: 0.2815 | Acc: 92.79%
2023-11-19 01:27 after_fed Round:  31 | Epochs: 155 | Domain: s | loss: 0.2362 | Acc: 92.46%
2023-11-19 01:27 test_domain Round:  31 | Epochs: 155 | Domain: c | loss: 1.1075 | Acc: 72.82%
2023-11-19 01:27 Round 31 FedAvg weight: {'p': 0.18493432273397192, 'a': 0.5045110508936959, 's': 0.3105546263723322}
2023-11-19 01:27 before_fed Round:  32 | Epochs: 160 | Domain: p | loss: 0.0490 | Acc: 98.25%
2023-11-19 01:27 before_fed Round:  32 | Epochs: 160 | Domain: a | loss: 0.2481 | Acc: 93.27%
2023-11-19 01:27 before_fed Round:  32 | Epochs: 160 | Domain: s | loss: 0.1289 | Acc: 95.48%
2023-11-19 01:27 after_fed Round:  32 | Epochs: 160 | Domain: p | loss: 0.0540 | Acc: 98.25%
2023-11-19 01:27 after_fed Round:  32 | Epochs: 160 | Domain: a | loss: 0.2626 | Acc: 92.31%
2023-11-19 01:27 after_fed Round:  32 | Epochs: 160 | Domain: s | loss: 0.2092 | Acc: 93.97%
2023-11-19 01:27 test_domain Round:  32 | Epochs: 160 | Domain: c | loss: 1.0820 | Acc: 74.32%
2023-11-19 01:27 Round 32 FedAvg weight: {'p': 0.18049992552515678, 'a': 0.5017516709018288, 's': 0.3177484035730144}
2023-11-19 01:28 before_fed Round:  33 | Epochs: 165 | Domain: p | loss: 0.0077 | Acc: 100.00%
2023-11-19 01:28 before_fed Round:  33 | Epochs: 165 | Domain: a | loss: 0.2379 | Acc: 93.75%
2023-11-19 01:28 before_fed Round:  33 | Epochs: 165 | Domain: s | loss: 0.1520 | Acc: 94.22%
2023-11-19 01:28 after_fed Round:  33 | Epochs: 165 | Domain: p | loss: 0.0329 | Acc: 98.83%
2023-11-19 01:28 after_fed Round:  33 | Epochs: 165 | Domain: a | loss: 0.2841 | Acc: 92.79%
2023-11-19 01:28 after_fed Round:  33 | Epochs: 165 | Domain: s | loss: 0.2076 | Acc: 94.47%
2023-11-19 01:28 test_domain Round:  33 | Epochs: 165 | Domain: c | loss: 1.0463 | Acc: 74.32%
2023-11-19 01:28 Round 33 FedAvg weight: {'p': 0.18976645923018037, 'a': 0.5019560157757039, 's': 0.3082775249941156}
2023-11-19 01:28 before_fed Round:  34 | Epochs: 170 | Domain: p | loss: 0.0101 | Acc: 99.42%
2023-11-19 01:29 before_fed Round:  34 | Epochs: 170 | Domain: a | loss: 0.2099 | Acc: 94.71%
2023-11-19 01:29 before_fed Round:  34 | Epochs: 170 | Domain: s | loss: 0.1666 | Acc: 95.23%
2023-11-19 01:29 after_fed Round:  34 | Epochs: 170 | Domain: p | loss: 0.0397 | Acc: 98.25%
2023-11-19 01:29 after_fed Round:  34 | Epochs: 170 | Domain: a | loss: 0.2791 | Acc: 92.79%
2023-11-19 01:29 after_fed Round:  34 | Epochs: 170 | Domain: s | loss: 0.2315 | Acc: 93.47%
2023-11-19 01:29 test_domain Round:  34 | Epochs: 170 | Domain: c | loss: 1.1009 | Acc: 74.06%
2023-11-19 01:29 Round 34 FedAvg weight: {'p': 0.19123355166275519, 'a': 0.49893784403597735, 's': 0.3098286043012675}
2023-11-19 01:29 before_fed Round:  35 | Epochs: 175 | Domain: p | loss: 0.0175 | Acc: 99.42%
2023-11-19 01:29 before_fed Round:  35 | Epochs: 175 | Domain: a | loss: 0.2528 | Acc: 92.31%
2023-11-19 01:30 before_fed Round:  35 | Epochs: 175 | Domain: s | loss: 0.1932 | Acc: 93.97%
2023-11-19 01:30 after_fed Round:  35 | Epochs: 175 | Domain: p | loss: 0.0456 | Acc: 98.25%
2023-11-19 01:30 after_fed Round:  35 | Epochs: 175 | Domain: a | loss: 0.2783 | Acc: 91.35%
2023-11-19 01:30 after_fed Round:  35 | Epochs: 175 | Domain: s | loss: 0.2169 | Acc: 93.22%
2023-11-19 01:30 test_domain Round:  35 | Epochs: 175 | Domain: c | loss: 0.9667 | Acc: 75.73%
2023-11-19 01:30 Round 35 FedAvg weight: {'p': 0.1963894339496801, 'a': 0.4949506068624097, 's': 0.30865995918791034}
2023-11-19 01:30 before_fed Round:  36 | Epochs: 180 | Domain: p | loss: 0.0055 | Acc: 100.00%
2023-11-19 01:30 before_fed Round:  36 | Epochs: 180 | Domain: a | loss: 0.2357 | Acc: 92.79%
2023-11-19 01:31 before_fed Round:  36 | Epochs: 180 | Domain: s | loss: 0.1972 | Acc: 94.22%
2023-11-19 01:31 after_fed Round:  36 | Epochs: 180 | Domain: p | loss: 0.0526 | Acc: 98.25%
2023-11-19 01:31 after_fed Round:  36 | Epochs: 180 | Domain: a | loss: 0.2860 | Acc: 91.83%
2023-11-19 01:31 after_fed Round:  36 | Epochs: 180 | Domain: s | loss: 0.2246 | Acc: 92.96%
2023-11-19 01:31 test_domain Round:  36 | Epochs: 180 | Domain: c | loss: 1.0499 | Acc: 74.53%
2023-11-19 01:31 Round 36 FedAvg weight: {'p': 0.20093159443810962, 'a': 0.4902675572137342, 's': 0.30880084834815613}
2023-11-19 01:31 before_fed Round:  37 | Epochs: 185 | Domain: p | loss: 0.0134 | Acc: 99.42%
2023-11-19 01:31 before_fed Round:  37 | Epochs: 185 | Domain: a | loss: 0.2685 | Acc: 91.35%
2023-11-19 01:31 before_fed Round:  37 | Epochs: 185 | Domain: s | loss: 0.1783 | Acc: 94.97%
2023-11-19 01:31 after_fed Round:  37 | Epochs: 185 | Domain: p | loss: 0.0258 | Acc: 98.83%
2023-11-19 01:31 after_fed Round:  37 | Epochs: 185 | Domain: a | loss: 0.3244 | Acc: 91.83%
2023-11-19 01:31 after_fed Round:  37 | Epochs: 185 | Domain: s | loss: 0.2131 | Acc: 92.96%
2023-11-19 01:31 test_domain Round:  37 | Epochs: 185 | Domain: c | loss: 0.9831 | Acc: 75.55%
2023-11-19 01:31 Round 37 FedAvg weight: {'p': 0.20145860102807644, 'a': 0.4852704417098519, 's': 0.31327095726207177}
2023-11-19 01:32 before_fed Round:  38 | Epochs: 190 | Domain: p | loss: 0.0097 | Acc: 100.00%
2023-11-19 01:32 before_fed Round:  38 | Epochs: 190 | Domain: a | loss: 0.2678 | Acc: 92.31%
2023-11-19 01:32 before_fed Round:  38 | Epochs: 190 | Domain: s | loss: 0.1428 | Acc: 95.98%
2023-11-19 01:32 after_fed Round:  38 | Epochs: 190 | Domain: p | loss: 0.0313 | Acc: 98.83%
2023-11-19 01:32 after_fed Round:  38 | Epochs: 190 | Domain: a | loss: 0.2855 | Acc: 91.83%
2023-11-19 01:32 after_fed Round:  38 | Epochs: 190 | Domain: s | loss: 0.3035 | Acc: 92.46%
2023-11-19 01:32 test_domain Round:  38 | Epochs: 190 | Domain: c | loss: 1.0463 | Acc: 73.98%
2023-11-19 01:32 Round 38 FedAvg weight: {'p': 0.20163987057578292, 'a': 0.4824100995901499, 's': 0.31595002983406717}
2023-11-19 01:32 before_fed Round:  39 | Epochs: 195 | Domain: p | loss: 0.0120 | Acc: 99.42%
2023-11-19 01:33 before_fed Round:  39 | Epochs: 195 | Domain: a | loss: 0.2820 | Acc: 92.79%
2023-11-19 01:33 before_fed Round:  39 | Epochs: 195 | Domain: s | loss: 0.1201 | Acc: 95.48%
2023-11-19 01:33 after_fed Round:  39 | Epochs: 195 | Domain: p | loss: 0.0289 | Acc: 98.25%
2023-11-19 01:33 after_fed Round:  39 | Epochs: 195 | Domain: a | loss: 0.3418 | Acc: 90.87%
2023-11-19 01:33 after_fed Round:  39 | Epochs: 195 | Domain: s | loss: 0.2111 | Acc: 93.22%
2023-11-19 01:33 test_domain Round:  39 | Epochs: 195 | Domain: c | loss: 1.0189 | Acc: 74.53%
2023-11-19 01:33 Round 39 FedAvg weight: {'p': 0.20177152181408745, 'a': 0.4814452174277495, 's': 0.3167832607581631}
2023-11-19 01:33 before_fed Round:  40 | Epochs: 200 | Domain: p | loss: 0.0059 | Acc: 100.00%
2023-11-19 01:33 before_fed Round:  40 | Epochs: 200 | Domain: a | loss: 0.2713 | Acc: 92.79%
2023-11-19 01:34 before_fed Round:  40 | Epochs: 200 | Domain: s | loss: 0.1656 | Acc: 94.22%
2023-11-19 01:34 after_fed Round:  40 | Epochs: 200 | Domain: p | loss: 0.0319 | Acc: 98.25%
2023-11-19 01:34 after_fed Round:  40 | Epochs: 200 | Domain: a | loss: 0.3498 | Acc: 90.38%
2023-11-19 01:34 after_fed Round:  40 | Epochs: 200 | Domain: s | loss: 0.2157 | Acc: 92.96%
2023-11-19 01:34 test_domain Round:  40 | Epochs: 200 | Domain: c | loss: 0.9573 | Acc: 75.55%
2023-11-19 01:34 Round 40 FedAvg weight: {'p': 0.20222871679822385, 'a': 0.481305034810513, 's': 0.31646624839126314}
