2023-11-19 12:07 before_fed Round:   0 | Epochs:   0 | Domain: p | loss: 0.0555 | Acc: 99.42%
2023-11-19 12:07 before_fed Round:   0 | Epochs:   0 | Domain: a | loss: 0.2778 | Acc: 91.83%
2023-11-19 12:07 before_fed Round:   0 | Epochs:   0 | Domain: s | loss: 0.1927 | Acc: 93.47%
2023-11-19 12:08 after_fed Round:   0 | Epochs:   0 | Domain: p | loss: 0.1331 | Acc: 97.08%
2023-11-19 12:08 after_fed Round:   0 | Epochs:   0 | Domain: a | loss: 0.6215 | Acc: 78.37%
2023-11-19 12:08 after_fed Round:   0 | Epochs:   0 | Domain: s | loss: 0.8986 | Acc: 64.32%
2023-11-19 12:08 Model saved! Best Val Acc: 79.92%
2023-11-19 12:08 test_domain Round:   0 | Epochs:   0 | Domain: c | loss: 0.9942 | Acc: 62.71%
2023-11-19 12:08 Round 0 FedAvg weight: {'p': 0.30651723311081164, 'a': 0.3301080735317042, 's': 0.36337469335748407}
2023-11-19 12:08 before_fed Round:   1 | Epochs:   5 | Domain: p | loss: 0.0291 | Acc: 99.42%
2023-11-19 12:08 before_fed Round:   1 | Epochs:   5 | Domain: a | loss: 0.2575 | Acc: 90.87%
2023-11-19 12:08 before_fed Round:   1 | Epochs:   5 | Domain: s | loss: 0.1382 | Acc: 94.97%
2023-11-19 12:08 after_fed Round:   1 | Epochs:   5 | Domain: p | loss: 0.0511 | Acc: 99.42%
2023-11-19 12:08 after_fed Round:   1 | Epochs:   5 | Domain: a | loss: 0.4374 | Acc: 85.10%
2023-11-19 12:08 after_fed Round:   1 | Epochs:   5 | Domain: s | loss: 0.4751 | Acc: 82.91%
2023-11-19 12:08 Model saved! Best Val Acc: 88.69%
2023-11-19 12:08 test_domain Round:   1 | Epochs:   5 | Domain: c | loss: 0.9273 | Acc: 68.73%
2023-11-19 12:08 Round 1 FedAvg weight: {'p': 0.2790178752168439, 'a': 0.3295221559209095, 's': 0.3914599688622467}
2023-11-19 12:08 before_fed Round:   2 | Epochs:  10 | Domain: p | loss: 0.0231 | Acc: 99.42%
2023-11-19 12:09 before_fed Round:   2 | Epochs:  10 | Domain: a | loss: 0.2388 | Acc: 89.90%
2023-11-19 12:09 before_fed Round:   2 | Epochs:  10 | Domain: s | loss: 0.1551 | Acc: 95.23%
2023-11-19 12:09 after_fed Round:   2 | Epochs:  10 | Domain: p | loss: 0.0446 | Acc: 98.83%
2023-11-19 12:09 after_fed Round:   2 | Epochs:  10 | Domain: a | loss: 0.3673 | Acc: 88.46%
2023-11-19 12:09 after_fed Round:   2 | Epochs:  10 | Domain: s | loss: 0.3200 | Acc: 87.94%
2023-11-19 12:09 Model saved! Best Val Acc: 91.15%
2023-11-19 12:09 test_domain Round:   2 | Epochs:  10 | Domain: c | loss: 0.8573 | Acc: 73.89%
2023-11-19 12:09 Round 2 FedAvg weight: {'p': 0.26243105248728565, 'a': 0.31612395876925653, 's': 0.42144498874345776}
2023-11-19 12:09 before_fed Round:   3 | Epochs:  15 | Domain: p | loss: 0.0208 | Acc: 99.42%
2023-11-19 12:09 before_fed Round:   3 | Epochs:  15 | Domain: a | loss: 0.2269 | Acc: 90.87%
2023-11-19 12:10 before_fed Round:   3 | Epochs:  15 | Domain: s | loss: 0.1817 | Acc: 94.22%
2023-11-19 12:10 after_fed Round:   3 | Epochs:  15 | Domain: p | loss: 0.0505 | Acc: 97.08%
2023-11-19 12:10 after_fed Round:   3 | Epochs:  15 | Domain: a | loss: 0.4052 | Acc: 87.02%
2023-11-19 12:10 after_fed Round:   3 | Epochs:  15 | Domain: s | loss: 0.2566 | Acc: 91.46%
2023-11-19 12:10 Model saved! Best Val Acc: 91.53%
2023-11-19 12:10 test_domain Round:   3 | Epochs:  15 | Domain: c | loss: 1.0080 | Acc: 71.37%
2023-11-19 12:10 Round 3 FedAvg weight: {'p': 0.26229679648165644, 'a': 0.3307212958884526, 's': 0.40698190762989095}
2023-11-19 12:10 before_fed Round:   4 | Epochs:  20 | Domain: p | loss: 0.0216 | Acc: 98.83%
2023-11-19 12:10 before_fed Round:   4 | Epochs:  20 | Domain: a | loss: 0.2584 | Acc: 93.27%
2023-11-19 12:11 before_fed Round:   4 | Epochs:  20 | Domain: s | loss: 0.1747 | Acc: 94.47%
2023-11-19 12:11 after_fed Round:   4 | Epochs:  20 | Domain: p | loss: 0.0337 | Acc: 98.83%
2023-11-19 12:11 after_fed Round:   4 | Epochs:  20 | Domain: a | loss: 0.3649 | Acc: 88.46%
2023-11-19 12:11 after_fed Round:   4 | Epochs:  20 | Domain: s | loss: 0.1998 | Acc: 94.22%
2023-11-19 12:11 Model saved! Best Val Acc: 93.53%
2023-11-19 12:11 test_domain Round:   4 | Epochs:  20 | Domain: c | loss: 0.9277 | Acc: 73.12%
2023-11-19 12:11 Round 4 FedAvg weight: {'p': 0.24631364050270455, 'a': 0.36847765143463934, 's': 0.385208708062656}
2023-11-19 12:11 before_fed Round:   5 | Epochs:  25 | Domain: p | loss: 0.0301 | Acc: 98.83%
2023-11-19 12:11 before_fed Round:   5 | Epochs:  25 | Domain: a | loss: 0.2620 | Acc: 92.79%
2023-11-19 12:11 before_fed Round:   5 | Epochs:  25 | Domain: s | loss: 0.1442 | Acc: 93.97%
2023-11-19 12:11 after_fed Round:   5 | Epochs:  25 | Domain: p | loss: 0.0427 | Acc: 97.66%
2023-11-19 12:11 after_fed Round:   5 | Epochs:  25 | Domain: a | loss: 0.3560 | Acc: 89.90%
2023-11-19 12:11 after_fed Round:   5 | Epochs:  25 | Domain: s | loss: 0.2567 | Acc: 90.45%
2023-11-19 12:11 test_domain Round:   5 | Epochs:  25 | Domain: c | loss: 0.9219 | Acc: 74.45%
2023-11-19 12:11 Round 5 FedAvg weight: {'p': 0.23580814537468367, 'a': 0.3699063676398848, 's': 0.39428548698543164}
2023-11-19 12:12 before_fed Round:   6 | Epochs:  30 | Domain: p | loss: 0.0141 | Acc: 99.42%
2023-11-19 12:12 before_fed Round:   6 | Epochs:  30 | Domain: a | loss: 0.2275 | Acc: 91.35%
2023-11-19 12:12 before_fed Round:   6 | Epochs:  30 | Domain: s | loss: 0.1583 | Acc: 94.72%
2023-11-19 12:12 after_fed Round:   6 | Epochs:  30 | Domain: p | loss: 0.0666 | Acc: 97.66%
2023-11-19 12:12 after_fed Round:   6 | Epochs:  30 | Domain: a | loss: 0.3552 | Acc: 89.90%
2023-11-19 12:12 after_fed Round:   6 | Epochs:  30 | Domain: s | loss: 0.1688 | Acc: 94.47%
2023-11-19 12:12 Model saved! Best Val Acc: 93.53%
2023-11-19 12:12 test_domain Round:   6 | Epochs:  30 | Domain: c | loss: 0.8651 | Acc: 76.45%
2023-11-19 12:12 Round 6 FedAvg weight: {'p': 0.2638881922696896, 'a': 0.37488469201874414, 's': 0.3612271157115661}
2023-11-19 12:12 before_fed Round:   7 | Epochs:  35 | Domain: p | loss: 0.0115 | Acc: 99.42%
2023-11-19 12:13 before_fed Round:   7 | Epochs:  35 | Domain: a | loss: 0.2346 | Acc: 93.27%
2023-11-19 12:13 before_fed Round:   7 | Epochs:  35 | Domain: s | loss: 0.1947 | Acc: 94.22%
2023-11-19 12:13 after_fed Round:   7 | Epochs:  35 | Domain: p | loss: 0.0348 | Acc: 98.25%
2023-11-19 12:13 after_fed Round:   7 | Epochs:  35 | Domain: a | loss: 0.3396 | Acc: 90.87%
2023-11-19 12:13 after_fed Round:   7 | Epochs:  35 | Domain: s | loss: 0.1937 | Acc: 92.46%
2023-11-19 12:13 test_domain Round:   7 | Epochs:  35 | Domain: c | loss: 0.8971 | Acc: 75.85%
2023-11-19 12:13 Round 7 FedAvg weight: {'p': 0.2589142247800955, 'a': 0.383363197691142, 's': 0.35772257752876246}
2023-11-19 12:13 before_fed Round:   8 | Epochs:  40 | Domain: p | loss: 0.0176 | Acc: 98.83%
2023-11-19 12:13 before_fed Round:   8 | Epochs:  40 | Domain: a | loss: 0.2322 | Acc: 94.23%
2023-11-19 12:14 before_fed Round:   8 | Epochs:  40 | Domain: s | loss: 0.1754 | Acc: 93.72%
2023-11-19 12:14 after_fed Round:   8 | Epochs:  40 | Domain: p | loss: 0.0455 | Acc: 98.25%
2023-11-19 12:14 after_fed Round:   8 | Epochs:  40 | Domain: a | loss: 0.3776 | Acc: 89.90%
2023-11-19 12:14 after_fed Round:   8 | Epochs:  40 | Domain: s | loss: 0.2604 | Acc: 91.71%
2023-11-19 12:14 test_domain Round:   8 | Epochs:  40 | Domain: c | loss: 0.9502 | Acc: 75.51%
2023-11-19 12:14 Round 8 FedAvg weight: {'p': 0.24480854242691377, 'a': 0.40291350917680446, 's': 0.3522779483962818}
2023-11-19 12:14 before_fed Round:   9 | Epochs:  45 | Domain: p | loss: 0.0244 | Acc: 98.83%
2023-11-19 12:14 before_fed Round:   9 | Epochs:  45 | Domain: a | loss: 0.3489 | Acc: 91.35%
2023-11-19 12:14 before_fed Round:   9 | Epochs:  45 | Domain: s | loss: 0.1710 | Acc: 94.47%
2023-11-19 12:14 after_fed Round:   9 | Epochs:  45 | Domain: p | loss: 0.0466 | Acc: 97.66%
2023-11-19 12:14 after_fed Round:   9 | Epochs:  45 | Domain: a | loss: 0.3667 | Acc: 90.38%
2023-11-19 12:14 after_fed Round:   9 | Epochs:  45 | Domain: s | loss: 0.2030 | Acc: 92.46%
2023-11-19 12:14 test_domain Round:   9 | Epochs:  45 | Domain: c | loss: 0.9617 | Acc: 75.17%
2023-11-19 12:14 Round 9 FedAvg weight: {'p': 0.2485330456700766, 'a': 0.3860116435022239, 's': 0.3654553108276994}
2023-11-19 12:15 before_fed Round:  10 | Epochs:  50 | Domain: p | loss: 0.0351 | Acc: 98.83%
2023-11-19 12:15 before_fed Round:  10 | Epochs:  50 | Domain: a | loss: 0.3375 | Acc: 91.35%
2023-11-19 12:15 before_fed Round:  10 | Epochs:  50 | Domain: s | loss: 0.1640 | Acc: 95.23%
2023-11-19 12:15 after_fed Round:  10 | Epochs:  50 | Domain: p | loss: 0.0361 | Acc: 98.25%
2023-11-19 12:15 after_fed Round:  10 | Epochs:  50 | Domain: a | loss: 0.3929 | Acc: 88.94%
2023-11-19 12:15 after_fed Round:  10 | Epochs:  50 | Domain: s | loss: 0.2057 | Acc: 94.22%
2023-11-19 12:15 test_domain Round:  10 | Epochs:  50 | Domain: c | loss: 1.0933 | Acc: 73.29%
2023-11-19 12:15 Round 10 FedAvg weight: {'p': 0.2404616867530195, 'a': 0.40307912378936844, 's': 0.35645918945761196}
2023-11-19 12:15 before_fed Round:  11 | Epochs:  55 | Domain: p | loss: 0.0238 | Acc: 99.42%
2023-11-19 12:16 before_fed Round:  11 | Epochs:  55 | Domain: a | loss: 0.2691 | Acc: 92.79%
2023-11-19 12:16 before_fed Round:  11 | Epochs:  55 | Domain: s | loss: 0.1541 | Acc: 94.97%
2023-11-19 12:16 after_fed Round:  11 | Epochs:  55 | Domain: p | loss: 0.0356 | Acc: 98.25%
2023-11-19 12:16 after_fed Round:  11 | Epochs:  55 | Domain: a | loss: 0.3047 | Acc: 89.90%
2023-11-19 12:16 after_fed Round:  11 | Epochs:  55 | Domain: s | loss: 0.1989 | Acc: 93.22%
2023-11-19 12:16 test_domain Round:  11 | Epochs:  55 | Domain: c | loss: 1.0042 | Acc: 75.68%
2023-11-19 12:16 Round 11 FedAvg weight: {'p': 0.23686807939045496, 'a': 0.41160622898161403, 's': 0.35152569162793107}
2023-11-19 12:16 before_fed Round:  12 | Epochs:  60 | Domain: p | loss: 0.0085 | Acc: 100.00%
2023-11-19 12:16 before_fed Round:  12 | Epochs:  60 | Domain: a | loss: 0.3005 | Acc: 92.31%
2023-11-19 12:17 before_fed Round:  12 | Epochs:  60 | Domain: s | loss: 0.1541 | Acc: 93.97%
2023-11-19 12:17 after_fed Round:  12 | Epochs:  60 | Domain: p | loss: 0.0284 | Acc: 98.83%
2023-11-19 12:17 after_fed Round:  12 | Epochs:  60 | Domain: a | loss: 0.3710 | Acc: 90.38%
2023-11-19 12:17 after_fed Round:  12 | Epochs:  60 | Domain: s | loss: 0.1932 | Acc: 92.46%
2023-11-19 12:17 test_domain Round:  12 | Epochs:  60 | Domain: c | loss: 1.0184 | Acc: 75.26%
2023-11-19 12:17 Round 12 FedAvg weight: {'p': 0.23866921603035426, 'a': 0.41227316110666146, 's': 0.3490576228629842}
2023-11-19 12:17 before_fed Round:  13 | Epochs:  65 | Domain: p | loss: 0.0189 | Acc: 99.42%
2023-11-19 12:17 before_fed Round:  13 | Epochs:  65 | Domain: a | loss: 0.3571 | Acc: 90.87%
2023-11-19 12:17 before_fed Round:  13 | Epochs:  65 | Domain: s | loss: 0.1806 | Acc: 93.97%
2023-11-19 12:17 after_fed Round:  13 | Epochs:  65 | Domain: p | loss: 0.0200 | Acc: 100.00%
2023-11-19 12:17 after_fed Round:  13 | Epochs:  65 | Domain: a | loss: 0.3585 | Acc: 91.35%
2023-11-19 12:17 after_fed Round:  13 | Epochs:  65 | Domain: s | loss: 0.2158 | Acc: 92.71%
2023-11-19 12:17 Model saved! Best Val Acc: 93.89%
2023-11-19 12:17 test_domain Round:  13 | Epochs:  65 | Domain: c | loss: 1.0411 | Acc: 74.91%
2023-11-19 12:17 Round 13 FedAvg weight: {'p': 0.21541987800871087, 'a': 0.39163961766744654, 's': 0.39294050432384253}
2023-11-19 12:18 before_fed Round:  14 | Epochs:  70 | Domain: p | loss: 0.0236 | Acc: 99.42%
2023-11-19 12:18 before_fed Round:  14 | Epochs:  70 | Domain: a | loss: 0.2777 | Acc: 92.79%
2023-11-19 12:18 before_fed Round:  14 | Epochs:  70 | Domain: s | loss: 0.1343 | Acc: 94.47%
2023-11-19 12:18 after_fed Round:  14 | Epochs:  70 | Domain: p | loss: 0.0334 | Acc: 98.83%
2023-11-19 12:18 after_fed Round:  14 | Epochs:  70 | Domain: a | loss: 0.3646 | Acc: 89.90%
2023-11-19 12:18 after_fed Round:  14 | Epochs:  70 | Domain: s | loss: 0.1678 | Acc: 94.97%
2023-11-19 12:18 test_domain Round:  14 | Epochs:  70 | Domain: c | loss: 1.0326 | Acc: 74.53%
2023-11-19 12:18 Round 14 FedAvg weight: {'p': 0.21460976991082378, 'a': 0.4173243402278015, 's': 0.3680658898613748}
2023-11-19 12:18 before_fed Round:  15 | Epochs:  75 | Domain: p | loss: 0.0083 | Acc: 99.42%
2023-11-19 12:19 before_fed Round:  15 | Epochs:  75 | Domain: a | loss: 0.2683 | Acc: 93.75%
2023-11-19 12:19 before_fed Round:  15 | Epochs:  75 | Domain: s | loss: 0.1872 | Acc: 93.22%
2023-11-19 12:19 after_fed Round:  15 | Epochs:  75 | Domain: p | loss: 0.0407 | Acc: 97.66%
2023-11-19 12:19 after_fed Round:  15 | Epochs:  75 | Domain: a | loss: 0.3177 | Acc: 91.35%
2023-11-19 12:19 after_fed Round:  15 | Epochs:  75 | Domain: s | loss: 0.1732 | Acc: 93.97%
2023-11-19 12:19 test_domain Round:  15 | Epochs:  75 | Domain: c | loss: 1.0763 | Acc: 73.25%
2023-11-19 12:19 Round 15 FedAvg weight: {'p': 0.23199755033004918, 'a': 0.4340212983673923, 's': 0.3339811513025585}
2023-11-19 12:19 before_fed Round:  16 | Epochs:  80 | Domain: p | loss: 0.0148 | Acc: 99.42%
2023-11-19 12:19 before_fed Round:  16 | Epochs:  80 | Domain: a | loss: 0.2818 | Acc: 90.87%
2023-11-19 12:20 before_fed Round:  16 | Epochs:  80 | Domain: s | loss: 0.1703 | Acc: 93.97%
2023-11-19 12:20 after_fed Round:  16 | Epochs:  80 | Domain: p | loss: 0.0279 | Acc: 98.25%
2023-11-19 12:20 after_fed Round:  16 | Epochs:  80 | Domain: a | loss: 0.3314 | Acc: 91.83%
2023-11-19 12:20 after_fed Round:  16 | Epochs:  80 | Domain: s | loss: 0.1819 | Acc: 92.71%
2023-11-19 12:20 test_domain Round:  16 | Epochs:  80 | Domain: c | loss: 1.0413 | Acc: 74.91%
2023-11-19 12:20 Round 16 FedAvg weight: {'p': 0.2582466898129401, 'a': 0.38350458117744735, 's': 0.3582487290096124}
2023-11-19 12:20 before_fed Round:  17 | Epochs:  85 | Domain: p | loss: 0.0390 | Acc: 98.83%
2023-11-19 12:20 before_fed Round:  17 | Epochs:  85 | Domain: a | loss: 0.2456 | Acc: 92.79%
2023-11-19 12:21 before_fed Round:  17 | Epochs:  85 | Domain: s | loss: 0.1544 | Acc: 95.23%
2023-11-19 12:21 after_fed Round:  17 | Epochs:  85 | Domain: p | loss: 0.0185 | Acc: 99.42%
2023-11-19 12:21 after_fed Round:  17 | Epochs:  85 | Domain: a | loss: 0.3274 | Acc: 91.83%
2023-11-19 12:21 after_fed Round:  17 | Epochs:  85 | Domain: s | loss: 0.1723 | Acc: 93.97%
2023-11-19 12:21 Model saved! Best Val Acc: 94.55%
2023-11-19 12:21 test_domain Round:  17 | Epochs:  85 | Domain: c | loss: 1.0573 | Acc: 73.68%
2023-11-19 12:21 Round 17 FedAvg weight: {'p': 0.22778310973133592, 'a': 0.39365184088054306, 's': 0.37856504938812086}
2023-11-19 12:21 before_fed Round:  18 | Epochs:  90 | Domain: p | loss: 0.0145 | Acc: 98.83%
2023-11-19 12:21 before_fed Round:  18 | Epochs:  90 | Domain: a | loss: 0.2531 | Acc: 92.31%
2023-11-19 12:21 before_fed Round:  18 | Epochs:  90 | Domain: s | loss: 0.1316 | Acc: 95.73%
2023-11-19 12:21 after_fed Round:  18 | Epochs:  90 | Domain: p | loss: 0.0299 | Acc: 99.42%
2023-11-19 12:21 after_fed Round:  18 | Epochs:  90 | Domain: a | loss: 0.2892 | Acc: 90.38%
2023-11-19 12:21 after_fed Round:  18 | Epochs:  90 | Domain: s | loss: 0.1563 | Acc: 96.73%
2023-11-19 12:21 Model saved! Best Val Acc: 94.85%
2023-11-19 12:21 test_domain Round:  18 | Epochs:  90 | Domain: c | loss: 1.0129 | Acc: 75.73%
2023-11-19 12:21 Round 18 FedAvg weight: {'p': 0.21469995664525493, 'a': 0.42913447150419803, 's': 0.35616557185054687}
2023-11-19 12:22 before_fed Round:  19 | Epochs:  95 | Domain: p | loss: 0.0034 | Acc: 100.00%
2023-11-19 12:22 before_fed Round:  19 | Epochs:  95 | Domain: a | loss: 0.2386 | Acc: 93.75%
2023-11-19 12:22 before_fed Round:  19 | Epochs:  95 | Domain: s | loss: 0.1462 | Acc: 95.48%
2023-11-19 12:22 after_fed Round:  19 | Epochs:  95 | Domain: p | loss: 0.0270 | Acc: 98.83%
2023-11-19 12:22 after_fed Round:  19 | Epochs:  95 | Domain: a | loss: 0.3490 | Acc: 90.38%
2023-11-19 12:22 after_fed Round:  19 | Epochs:  95 | Domain: s | loss: 0.1483 | Acc: 94.72%
2023-11-19 12:22 test_domain Round:  19 | Epochs:  95 | Domain: c | loss: 1.0162 | Acc: 75.21%
2023-11-19 12:22 Round 19 FedAvg weight: {'p': 0.21505121681726855, 'a': 0.4404230269209349, 's': 0.3445257562617965}
2023-11-19 12:22 before_fed Round:  20 | Epochs: 100 | Domain: p | loss: 0.0066 | Acc: 100.00%
2023-11-19 12:22 before_fed Round:  20 | Epochs: 100 | Domain: a | loss: 0.2502 | Acc: 93.27%
2023-11-19 12:23 before_fed Round:  20 | Epochs: 100 | Domain: s | loss: 0.1695 | Acc: 94.72%
2023-11-19 12:23 after_fed Round:  20 | Epochs: 100 | Domain: p | loss: 0.0223 | Acc: 99.42%
2023-11-19 12:23 after_fed Round:  20 | Epochs: 100 | Domain: a | loss: 0.2840 | Acc: 92.31%
2023-11-19 12:23 after_fed Round:  20 | Epochs: 100 | Domain: s | loss: 0.2041 | Acc: 93.22%
2023-11-19 12:23 test_domain Round:  20 | Epochs: 100 | Domain: c | loss: 1.0264 | Acc: 75.55%
2023-11-19 12:23 Round 20 FedAvg weight: {'p': 0.2134915136876974, 'a': 0.4321098473053144, 's': 0.3543986390069881}
2023-11-19 12:23 before_fed Round:  21 | Epochs: 105 | Domain: p | loss: 0.0044 | Acc: 100.00%
2023-11-19 12:23 before_fed Round:  21 | Epochs: 105 | Domain: a | loss: 0.2527 | Acc: 92.31%
2023-11-19 12:24 before_fed Round:  21 | Epochs: 105 | Domain: s | loss: 0.1046 | Acc: 96.48%
2023-11-19 12:24 after_fed Round:  21 | Epochs: 105 | Domain: p | loss: 0.0236 | Acc: 98.83%
2023-11-19 12:24 after_fed Round:  21 | Epochs: 105 | Domain: a | loss: 0.3106 | Acc: 90.87%
2023-11-19 12:24 after_fed Round:  21 | Epochs: 105 | Domain: s | loss: 0.1689 | Acc: 95.23%
2023-11-19 12:24 test_domain Round:  21 | Epochs: 105 | Domain: c | loss: 0.9656 | Acc: 76.49%
2023-11-19 12:24 Round 21 FedAvg weight: {'p': 0.2207843855505015, 'a': 0.4272480854237034, 's': 0.35196752902579514}
2023-11-19 12:24 before_fed Round:  22 | Epochs: 110 | Domain: p | loss: 0.0128 | Acc: 98.83%
2023-11-19 12:24 before_fed Round:  22 | Epochs: 110 | Domain: a | loss: 0.2558 | Acc: 92.31%
2023-11-19 12:24 before_fed Round:  22 | Epochs: 110 | Domain: s | loss: 0.1603 | Acc: 94.22%
2023-11-19 12:24 after_fed Round:  22 | Epochs: 110 | Domain: p | loss: 0.0223 | Acc: 99.42%
2023-11-19 12:24 after_fed Round:  22 | Epochs: 110 | Domain: a | loss: 0.3483 | Acc: 89.90%
2023-11-19 12:24 after_fed Round:  22 | Epochs: 110 | Domain: s | loss: 0.2023 | Acc: 93.72%
2023-11-19 12:24 test_domain Round:  22 | Epochs: 110 | Domain: c | loss: 1.0835 | Acc: 74.91%
2023-11-19 12:24 Round 22 FedAvg weight: {'p': 0.20675747415814338, 'a': 0.44529637400135513, 's': 0.3479461518405014}
2023-11-19 12:25 before_fed Round:  23 | Epochs: 115 | Domain: p | loss: 0.0055 | Acc: 100.00%
2023-11-19 12:25 before_fed Round:  23 | Epochs: 115 | Domain: a | loss: 0.2803 | Acc: 94.23%
2023-11-19 12:25 before_fed Round:  23 | Epochs: 115 | Domain: s | loss: 0.1237 | Acc: 95.73%
2023-11-19 12:25 after_fed Round:  23 | Epochs: 115 | Domain: p | loss: 0.0247 | Acc: 98.83%
2023-11-19 12:25 after_fed Round:  23 | Epochs: 115 | Domain: a | loss: 0.2931 | Acc: 93.27%
2023-11-19 12:25 after_fed Round:  23 | Epochs: 115 | Domain: s | loss: 0.1407 | Acc: 94.22%
2023-11-19 12:25 test_domain Round:  23 | Epochs: 115 | Domain: c | loss: 0.9383 | Acc: 76.83%
2023-11-19 12:25 Round 23 FedAvg weight: {'p': 0.21450046327356895, 'a': 0.43307244362415465, 's': 0.3524270931022764}
2023-11-19 12:25 before_fed Round:  24 | Epochs: 120 | Domain: p | loss: 0.0133 | Acc: 98.83%
2023-11-19 12:26 before_fed Round:  24 | Epochs: 120 | Domain: a | loss: 0.2616 | Acc: 92.79%
2023-11-19 12:26 before_fed Round:  24 | Epochs: 120 | Domain: s | loss: 0.1824 | Acc: 94.72%
2023-11-19 12:26 after_fed Round:  24 | Epochs: 120 | Domain: p | loss: 0.0363 | Acc: 97.66%
2023-11-19 12:26 after_fed Round:  24 | Epochs: 120 | Domain: a | loss: 0.3220 | Acc: 90.87%
2023-11-19 12:26 after_fed Round:  24 | Epochs: 120 | Domain: s | loss: 0.1504 | Acc: 95.23%
2023-11-19 12:26 test_domain Round:  24 | Epochs: 120 | Domain: c | loss: 0.9820 | Acc: 76.75%
2023-11-19 12:26 Round 24 FedAvg weight: {'p': 0.2232142166289034, 'a': 0.4444450357042264, 's': 0.3323407476668701}
2023-11-19 12:26 before_fed Round:  25 | Epochs: 125 | Domain: p | loss: 0.0089 | Acc: 100.00%
2023-11-19 12:26 before_fed Round:  25 | Epochs: 125 | Domain: a | loss: 0.2554 | Acc: 93.75%
2023-11-19 12:27 before_fed Round:  25 | Epochs: 125 | Domain: s | loss: 0.1705 | Acc: 94.97%
2023-11-19 12:27 after_fed Round:  25 | Epochs: 125 | Domain: p | loss: 0.0492 | Acc: 97.08%
2023-11-19 12:27 after_fed Round:  25 | Epochs: 125 | Domain: a | loss: 0.3045 | Acc: 91.35%
2023-11-19 12:27 after_fed Round:  25 | Epochs: 125 | Domain: s | loss: 0.1761 | Acc: 93.47%
2023-11-19 12:27 test_domain Round:  25 | Epochs: 125 | Domain: c | loss: 0.9632 | Acc: 76.92%
2023-11-19 12:27 Round 25 FedAvg weight: {'p': 0.23521776371737899, 'a': 0.43900142769838596, 's': 0.32578080858423514}
2023-11-19 12:27 before_fed Round:  26 | Epochs: 130 | Domain: p | loss: 0.0052 | Acc: 100.00%
2023-11-19 12:27 before_fed Round:  26 | Epochs: 130 | Domain: a | loss: 0.2512 | Acc: 95.19%
2023-11-19 12:27 before_fed Round:  26 | Epochs: 130 | Domain: s | loss: 0.1868 | Acc: 94.97%
2023-11-19 12:27 after_fed Round:  26 | Epochs: 130 | Domain: p | loss: 0.0332 | Acc: 98.25%
2023-11-19 12:27 after_fed Round:  26 | Epochs: 130 | Domain: a | loss: 0.2932 | Acc: 91.83%
2023-11-19 12:27 after_fed Round:  26 | Epochs: 130 | Domain: s | loss: 0.1592 | Acc: 94.47%
2023-11-19 12:27 test_domain Round:  26 | Epochs: 130 | Domain: c | loss: 1.0110 | Acc: 76.62%
2023-11-19 12:27 Round 26 FedAvg weight: {'p': 0.2382977143747703, 'a': 0.44539909747552026, 's': 0.3163031881497095}
2023-11-19 12:28 before_fed Round:  27 | Epochs: 135 | Domain: p | loss: 0.0114 | Acc: 99.42%
2023-11-19 12:28 before_fed Round:  27 | Epochs: 135 | Domain: a | loss: 0.2324 | Acc: 93.75%
2023-11-19 12:28 before_fed Round:  27 | Epochs: 135 | Domain: s | loss: 0.1787 | Acc: 93.47%
2023-11-19 12:28 after_fed Round:  27 | Epochs: 135 | Domain: p | loss: 0.0387 | Acc: 97.66%
2023-11-19 12:28 after_fed Round:  27 | Epochs: 135 | Domain: a | loss: 0.3113 | Acc: 89.90%
2023-11-19 12:28 after_fed Round:  27 | Epochs: 135 | Domain: s | loss: 0.1832 | Acc: 93.47%
2023-11-19 12:28 test_domain Round:  27 | Epochs: 135 | Domain: c | loss: 0.9566 | Acc: 76.37%
2023-11-19 12:28 Round 27 FedAvg weight: {'p': 0.24076075537631197, 'a': 0.45332982109786757, 's': 0.3059094235258205}
2023-11-19 12:28 before_fed Round:  28 | Epochs: 140 | Domain: p | loss: 0.0184 | Acc: 99.42%
2023-11-19 12:29 before_fed Round:  28 | Epochs: 140 | Domain: a | loss: 0.2404 | Acc: 94.71%
2023-11-19 12:29 before_fed Round:  28 | Epochs: 140 | Domain: s | loss: 0.1412 | Acc: 96.48%
2023-11-19 12:29 after_fed Round:  28 | Epochs: 140 | Domain: p | loss: 0.0428 | Acc: 97.66%
2023-11-19 12:29 after_fed Round:  28 | Epochs: 140 | Domain: a | loss: 0.2727 | Acc: 91.35%
2023-11-19 12:29 after_fed Round:  28 | Epochs: 140 | Domain: s | loss: 0.2200 | Acc: 92.96%
2023-11-19 12:29 test_domain Round:  28 | Epochs: 140 | Domain: c | loss: 0.9528 | Acc: 76.49%
2023-11-19 12:29 Round 28 FedAvg weight: {'p': 0.2388591493432813, 'a': 0.4501121160118517, 's': 0.311028734644867}
2023-11-19 12:29 before_fed Round:  29 | Epochs: 145 | Domain: p | loss: 0.0115 | Acc: 99.42%
2023-11-19 12:29 before_fed Round:  29 | Epochs: 145 | Domain: a | loss: 0.2903 | Acc: 93.75%
2023-11-19 12:30 before_fed Round:  29 | Epochs: 145 | Domain: s | loss: 0.1536 | Acc: 95.23%
2023-11-19 12:30 after_fed Round:  29 | Epochs: 145 | Domain: p | loss: 0.0260 | Acc: 98.25%
2023-11-19 12:30 after_fed Round:  29 | Epochs: 145 | Domain: a | loss: 0.2866 | Acc: 90.87%
2023-11-19 12:30 after_fed Round:  29 | Epochs: 145 | Domain: s | loss: 0.1931 | Acc: 93.72%
2023-11-19 12:30 test_domain Round:  29 | Epochs: 145 | Domain: c | loss: 1.0479 | Acc: 75.60%
2023-11-19 12:30 Round 29 FedAvg weight: {'p': 0.23779846395555593, 'a': 0.45265701725051366, 's': 0.3095445187939304}
2023-11-19 12:30 before_fed Round:  30 | Epochs: 150 | Domain: p | loss: 0.0093 | Acc: 100.00%
2023-11-19 12:30 before_fed Round:  30 | Epochs: 150 | Domain: a | loss: 0.2280 | Acc: 93.75%
2023-11-19 12:31 before_fed Round:  30 | Epochs: 150 | Domain: s | loss: 0.1288 | Acc: 95.73%
2023-11-19 12:31 after_fed Round:  30 | Epochs: 150 | Domain: p | loss: 0.0181 | Acc: 99.42%
2023-11-19 12:31 after_fed Round:  30 | Epochs: 150 | Domain: a | loss: 0.3150 | Acc: 90.87%
2023-11-19 12:31 after_fed Round:  30 | Epochs: 150 | Domain: s | loss: 0.1865 | Acc: 94.22%
2023-11-19 12:31 test_domain Round:  30 | Epochs: 150 | Domain: c | loss: 1.0530 | Acc: 75.04%
2023-11-19 12:31 Round 30 FedAvg weight: {'p': 0.23410996706026474, 'a': 0.4565491211426661, 's': 0.3093409117970692}
2023-11-19 12:31 before_fed Round:  31 | Epochs: 155 | Domain: p | loss: 0.0144 | Acc: 99.42%
2023-11-19 12:31 before_fed Round:  31 | Epochs: 155 | Domain: a | loss: 0.2422 | Acc: 95.19%
2023-11-19 12:31 before_fed Round:  31 | Epochs: 155 | Domain: s | loss: 0.1986 | Acc: 94.97%
2023-11-19 12:31 after_fed Round:  31 | Epochs: 155 | Domain: p | loss: 0.0214 | Acc: 98.83%
2023-11-19 12:31 after_fed Round:  31 | Epochs: 155 | Domain: a | loss: 0.2876 | Acc: 92.31%
2023-11-19 12:31 after_fed Round:  31 | Epochs: 155 | Domain: s | loss: 0.1903 | Acc: 94.22%
2023-11-19 12:31 test_domain Round:  31 | Epochs: 155 | Domain: c | loss: 1.0386 | Acc: 75.77%
2023-11-19 12:31 Round 31 FedAvg weight: {'p': 0.2318319474887679, 'a': 0.4619440783832099, 's': 0.30622397412802216}
2023-11-19 12:31 before_fed Round:  32 | Epochs: 160 | Domain: p | loss: 0.0072 | Acc: 100.00%
2023-11-19 12:32 before_fed Round:  32 | Epochs: 160 | Domain: a | loss: 0.2110 | Acc: 94.23%
2023-11-19 12:32 before_fed Round:  32 | Epochs: 160 | Domain: s | loss: 0.1318 | Acc: 94.97%
2023-11-19 12:32 after_fed Round:  32 | Epochs: 160 | Domain: p | loss: 0.0206 | Acc: 99.42%
2023-11-19 12:32 after_fed Round:  32 | Epochs: 160 | Domain: a | loss: 0.2970 | Acc: 90.38%
2023-11-19 12:32 after_fed Round:  32 | Epochs: 160 | Domain: s | loss: 0.1749 | Acc: 95.23%
2023-11-19 12:32 test_domain Round:  32 | Epochs: 160 | Domain: c | loss: 1.0442 | Acc: 75.55%
2023-11-19 12:32 Round 32 FedAvg weight: {'p': 0.2303576349868662, 'a': 0.4692942063255884, 's': 0.3003481586875455}
2023-11-19 12:32 before_fed Round:  33 | Epochs: 165 | Domain: p | loss: 0.0078 | Acc: 100.00%
2023-11-19 12:32 before_fed Round:  33 | Epochs: 165 | Domain: a | loss: 0.2312 | Acc: 94.23%
2023-11-19 12:33 before_fed Round:  33 | Epochs: 165 | Domain: s | loss: 0.1361 | Acc: 96.23%
2023-11-19 12:33 after_fed Round:  33 | Epochs: 165 | Domain: p | loss: 0.0334 | Acc: 98.25%
2023-11-19 12:33 after_fed Round:  33 | Epochs: 165 | Domain: a | loss: 0.2783 | Acc: 92.79%
2023-11-19 12:33 after_fed Round:  33 | Epochs: 165 | Domain: s | loss: 0.1774 | Acc: 95.23%
2023-11-19 12:33 test_domain Round:  33 | Epochs: 165 | Domain: c | loss: 1.0903 | Acc: 74.91%
2023-11-19 12:33 Round 33 FedAvg weight: {'p': 0.23614997630841555, 'a': 0.4653942800393055, 's': 0.29845574365227895}
2023-11-19 12:33 before_fed Round:  34 | Epochs: 170 | Domain: p | loss: 0.0123 | Acc: 100.00%
2023-11-19 12:33 before_fed Round:  34 | Epochs: 170 | Domain: a | loss: 0.2881 | Acc: 95.19%
2023-11-19 12:34 before_fed Round:  34 | Epochs: 170 | Domain: s | loss: 0.1592 | Acc: 95.23%
2023-11-19 12:34 after_fed Round:  34 | Epochs: 170 | Domain: p | loss: 0.0397 | Acc: 98.83%
2023-11-19 12:34 after_fed Round:  34 | Epochs: 170 | Domain: a | loss: 0.3017 | Acc: 92.79%
2023-11-19 12:34 after_fed Round:  34 | Epochs: 170 | Domain: s | loss: 0.1840 | Acc: 93.72%
2023-11-19 12:34 test_domain Round:  34 | Epochs: 170 | Domain: c | loss: 1.0179 | Acc: 76.02%
2023-11-19 12:34 Round 34 FedAvg weight: {'p': 0.23600654767097987, 'a': 0.4655799032678892, 's': 0.29841354906113116}
2023-11-19 12:34 before_fed Round:  35 | Epochs: 175 | Domain: p | loss: 0.0110 | Acc: 99.42%
2023-11-19 12:34 before_fed Round:  35 | Epochs: 175 | Domain: a | loss: 0.2951 | Acc: 92.79%
2023-11-19 12:34 before_fed Round:  35 | Epochs: 175 | Domain: s | loss: 0.1413 | Acc: 95.98%
2023-11-19 12:34 after_fed Round:  35 | Epochs: 175 | Domain: p | loss: 0.0268 | Acc: 98.83%
2023-11-19 12:34 after_fed Round:  35 | Epochs: 175 | Domain: a | loss: 0.3253 | Acc: 90.38%
2023-11-19 12:34 after_fed Round:  35 | Epochs: 175 | Domain: s | loss: 0.1542 | Acc: 94.72%
2023-11-19 12:34 test_domain Round:  35 | Epochs: 175 | Domain: c | loss: 1.0103 | Acc: 76.02%
2023-11-19 12:34 Round 35 FedAvg weight: {'p': 0.2343017892188751, 'a': 0.4673274247317795, 's': 0.29837078604934536}
2023-11-19 12:35 before_fed Round:  36 | Epochs: 180 | Domain: p | loss: 0.0194 | Acc: 98.25%
2023-11-19 12:35 before_fed Round:  36 | Epochs: 180 | Domain: a | loss: 0.2104 | Acc: 95.19%
2023-11-19 12:35 before_fed Round:  36 | Epochs: 180 | Domain: s | loss: 0.1234 | Acc: 96.73%
2023-11-19 12:35 after_fed Round:  36 | Epochs: 180 | Domain: p | loss: 0.0279 | Acc: 99.42%
2023-11-19 12:35 after_fed Round:  36 | Epochs: 180 | Domain: a | loss: 0.2831 | Acc: 92.79%
2023-11-19 12:35 after_fed Round:  36 | Epochs: 180 | Domain: s | loss: 0.1767 | Acc: 94.72%
2023-11-19 12:35 Model saved! Best Val Acc: 94.92%
2023-11-19 12:35 test_domain Round:  36 | Epochs: 180 | Domain: c | loss: 1.1836 | Acc: 74.53%
2023-11-19 12:35 Round 36 FedAvg weight: {'p': 0.22768643568291194, 'a': 0.4703705351620563, 's': 0.30194302915503185}
2023-11-19 12:35 before_fed Round:  37 | Epochs: 185 | Domain: p | loss: 0.0121 | Acc: 99.42%
2023-11-19 12:36 before_fed Round:  37 | Epochs: 185 | Domain: a | loss: 0.2451 | Acc: 95.67%
2023-11-19 12:36 before_fed Round:  37 | Epochs: 185 | Domain: s | loss: 0.1335 | Acc: 95.73%
2023-11-19 12:36 after_fed Round:  37 | Epochs: 185 | Domain: p | loss: 0.0294 | Acc: 98.83%
2023-11-19 12:36 after_fed Round:  37 | Epochs: 185 | Domain: a | loss: 0.3236 | Acc: 91.83%
2023-11-19 12:36 after_fed Round:  37 | Epochs: 185 | Domain: s | loss: 0.1858 | Acc: 93.72%
2023-11-19 12:36 test_domain Round:  37 | Epochs: 185 | Domain: c | loss: 1.1216 | Acc: 74.70%
2023-11-19 12:36 Round 37 FedAvg weight: {'p': 0.22617497326333685, 'a': 0.47177017140218547, 's': 0.3020548553344776}
2023-11-19 12:36 before_fed Round:  38 | Epochs: 190 | Domain: p | loss: 0.0061 | Acc: 100.00%
2023-11-19 12:36 before_fed Round:  38 | Epochs: 190 | Domain: a | loss: 0.2599 | Acc: 94.23%
2023-11-19 12:37 before_fed Round:  38 | Epochs: 190 | Domain: s | loss: 0.1415 | Acc: 95.48%
2023-11-19 12:37 after_fed Round:  38 | Epochs: 190 | Domain: p | loss: 0.0270 | Acc: 98.83%
2023-11-19 12:37 after_fed Round:  38 | Epochs: 190 | Domain: a | loss: 0.3290 | Acc: 92.31%
2023-11-19 12:37 after_fed Round:  38 | Epochs: 190 | Domain: s | loss: 0.1632 | Acc: 94.72%
2023-11-19 12:37 test_domain Round:  38 | Epochs: 190 | Domain: c | loss: 1.1581 | Acc: 74.40%
2023-11-19 12:37 Round 38 FedAvg weight: {'p': 0.22694627941168136, 'a': 0.47204933128998855, 's': 0.30100438929833023}
2023-11-19 12:37 before_fed Round:  39 | Epochs: 195 | Domain: p | loss: 0.0123 | Acc: 99.42%
2023-11-19 12:37 before_fed Round:  39 | Epochs: 195 | Domain: a | loss: 0.2790 | Acc: 93.75%
2023-11-19 12:37 before_fed Round:  39 | Epochs: 195 | Domain: s | loss: 0.1302 | Acc: 95.23%
2023-11-19 12:37 after_fed Round:  39 | Epochs: 195 | Domain: p | loss: 0.0429 | Acc: 98.83%
2023-11-19 12:37 after_fed Round:  39 | Epochs: 195 | Domain: a | loss: 0.3050 | Acc: 93.27%
2023-11-19 12:37 after_fed Round:  39 | Epochs: 195 | Domain: s | loss: 0.1539 | Acc: 94.47%
2023-11-19 12:38 test_domain Round:  39 | Epochs: 195 | Domain: c | loss: 1.1038 | Acc: 75.21%
2023-11-19 12:38 Round 39 FedAvg weight: {'p': 0.22770041139817498, 'a': 0.4703908715197696, 's': 0.30190871708205547}
2023-11-19 12:38 before_fed Round:  40 | Epochs: 200 | Domain: p | loss: 0.0107 | Acc: 100.00%
2023-11-19 12:38 before_fed Round:  40 | Epochs: 200 | Domain: a | loss: 0.2702 | Acc: 95.19%
2023-11-19 12:38 before_fed Round:  40 | Epochs: 200 | Domain: s | loss: 0.1207 | Acc: 95.73%
2023-11-19 12:38 after_fed Round:  40 | Epochs: 200 | Domain: p | loss: 0.0397 | Acc: 98.83%
2023-11-19 12:38 after_fed Round:  40 | Epochs: 200 | Domain: a | loss: 0.3212 | Acc: 93.27%
2023-11-19 12:38 after_fed Round:  40 | Epochs: 200 | Domain: s | loss: 0.1506 | Acc: 94.97%
2023-11-19 12:38 Model saved! Best Val Acc: 95.05%
2023-11-19 12:38 test_domain Round:  40 | Epochs: 200 | Domain: c | loss: 1.1180 | Acc: 75.26%
2023-11-19 12:38 Round 40 FedAvg weight: {'p': 0.2279541536201109, 'a': 0.470489125882473, 's': 0.3015567204974161}
